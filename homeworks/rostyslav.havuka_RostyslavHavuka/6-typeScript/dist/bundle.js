(new(function(){function e(e,t,r,s,i,o,a,n,c){void 0===e&&(e=document.querySelector("[data-score]")),void 0===t&&(t=document.querySelector("[data-cube]")),void 0===r&&(r=document.querySelector("[data-cube-score]")),void 0===s&&(s=document.querySelector("[data-key]")),void 0===i&&(i=document.querySelector("[data-progress-bar]")),void 0===o&&(o=document.querySelector("[data-key-start]")),void 0===a&&(a=document.querySelector("[data-key-stop]")),void 0===n&&(n=document.querySelector("[data-key-again]")),void 0===c&&(c=document.getElementById("box")),this.scoreElement=e,this.cubeElement=t,this.cubeScoreElement=r,this.keyElement=s,this.progressBarElement=i,this.keyStart=o,this.keyStop=a,this.keyAgain=n,this.square=c,this.currentKey="",this.score=100,this.gameState=!1,this.timerProgressBar=0}return e.prototype.start=function(){this.randomKeyInterval(),this.subscribeOnKeyPress(),this.subscribeOnKeyStartClick(),this.subscribeOnKeyStopClick(),this.subscribeOnKeyAgainClick()},e.prototype.subscribeOnKeyStartClick=function(){var e=this;this.keyStart.addEventListener("click",(function(){!1===e.gameState&&(e.squareWidth=1,e.progressBar(),e.progressBarElement.classList.remove("hidden"),clearInterval(e.intervalId),e.intervalId=setInterval((function(){e.subScoreTimer(e.score),e.sizeDown(),e.squareWidth=1,e.progressBar()}),3e3)),e.gameState=!0}))},e.prototype.subscribeOnKeyStopClick=function(){var e=this;this.keyStop.addEventListener("click",(function(){e.gameState=!1,e.progressBarElement.classList.add("hidden"),clearInterval(e.intervalStatusBarId),e.timerProgressBar=0,e.squareWidth=99,clearInterval(e.intervalId),alert("your Score:"+e.score),e.score=100,e.setCubeScore(e.score),e.resetScore("")}))},e.prototype.subscribeOnKeyAgainClick=function(){var e=this;this.keyAgain.addEventListener("click",(function(){e.gameAgain()}))},e.prototype.gameAgain=function(){var e=this;!0===this.gameState&&(this.score=100,this.squareWidth=1,this.progressBar(),this.setCubeScore(this.score),this.resetScore(""),clearInterval(this.intervalId),this.intervalId=setInterval((function(){e.subScoreTimer(e.score),e.sizeDown(),e.squareWidth=1,e.progressBar()}),3e3),this.gameState=!0)},e.prototype.randomKeyInterval=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",t=0;t<1;t++)this.currentKey=e.charAt(Math.floor(Math.random()*e.length)),this.keyElement.innerText=this.currentKey.toUpperCase()},e.prototype.pressCorrectKey=function(){!0===this.gameState?(this.randomKeyInterval(),this.addScore(),this.setNewInterval(),this.sizeUp(),clearInterval(this.intervalStatusBarId),this.squareWidth=1,this.timerProgressBar=0,this.progressBar()):alert('Please press "Start"')},e.prototype.pressUncorrectKey=function(){!0===this.gameState?(this.subScore(),this.randomKeyInterval(),this.setNewInterval(),this.sizeDown(),clearInterval(this.intervalStatusBarId),this.squareWidth=1,this.timerProgressBar=0,this.progressBar()):alert('Please press "Start"')},e.prototype.setKey=function(e){e===this.keyElement.textContent.toLowerCase()?this.pressCorrectKey():this.pressUncorrectKey()},e.prototype.setNewInterval=function(){var e=this;!0===this.gameState&&(clearInterval(this.intervalId),this.intervalId=setInterval((function(){e.subScoreTimer(e.score),e.sizeDown(),clearInterval(e.intervalStatusBarId),e.squareWidth=1,e.timerProgressBar=0,e.progressBar()}),3e3))},e.prototype.addScore=function(){var e=this.randomNumber(5,10);this.score=this.score+e,this.setCubeScore(this.score),this.scoreElement.innerText="+"+e},e.prototype.subScore=function(){var e=this.randomNumber(20,25);this.score=this.score-e,this.setCubeScore(this.score),this.scoreElement.innerText="-"+e},e.prototype.subScoreTimer=function(e){var t=this.randomNumber(10,15);this.score=this.score-t,this.finishGame(),this.setCubeScore(this.score),this.scoreElement.innerText="-"+t},e.prototype.subscribeOnKeyPress=function(){var e=this;window.addEventListener("keypress",(function(t){e.setKey(t.key),e.finishGame()}))},e.prototype.randomNumber=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.prototype.sizeUp=function(){var e=parseInt(this.square.style.width),t=parseInt(this.square.style.height);this.square.style.width=e+3+"px",this.square.style.height=t+3+"px"},e.prototype.sizeDown=function(){var e=parseInt(this.square.style.width),t=parseInt(this.square.style.height);this.square.style.width=e-2+"px",this.square.style.height=t-2+"px"},e.prototype.progressBar=function(){var e=this;0==this.timerProgressBar&&(this.timerProgressBar=1,this.squareWidth=1,this.intervalStatusBarId=setInterval((function(){e.squareWidth>=100?(clearInterval(e.intervalStatusBarId),e.timerProgressBar=0):(e.squareWidth++,e.progressBarElement.style.width=e.squareWidth+"%")}),30))},e.prototype.finishGame=function(){this.score>=200&&(alert("You WON! Your Score: 200"),this.gameAgain()),this.score<=0&&(alert("Try Again! Your Score:0"),this.gameAgain())},e.prototype.setCubeScore=function(e){return this.cubeScoreElement.innerText=e.toString()},e.prototype.resetScore=function(e){return this.scoreElement.innerText=e},e}())).start();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly82LXR5cGVzY3JpcHQvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsic2NvcmVFbGVtZW50IiwiY3ViZUVsZW1lbnQiLCJjdWJlU2NvcmVFbGVtZW50Iiwia2V5RWxlbWVudCIsInByb2dyZXNzQmFyRWxlbWVudCIsImtleVN0YXJ0Iiwia2V5U3RvcCIsImtleUFnYWluIiwic3F1YXJlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0RWxlbWVudEJ5SWQiLCJjdXJyZW50S2V5Iiwic2NvcmUiLCJnYW1lU3RhdGUiLCJ0aW1lclByb2dyZXNzQmFyIiwic3RhcnQiLCJ0aGlzIiwicmFuZG9tS2V5SW50ZXJ2YWwiLCJzdWJzY3JpYmVPbktleVByZXNzIiwic3Vic2NyaWJlT25LZXlTdGFydENsaWNrIiwic3Vic2NyaWJlT25LZXlTdG9wQ2xpY2siLCJzdWJzY3JpYmVPbktleUFnYWluQ2xpY2siLCJhZGRFdmVudExpc3RlbmVyIiwic3F1YXJlV2lkdGgiLCJwcm9ncmVzc0JhciIsImNsYXNzTGlzdCIsInJlbW92ZSIsImNsZWFySW50ZXJ2YWwiLCJpbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJzdWJTY29yZVRpbWVyIiwic2l6ZURvd24iLCJhZGQiLCJpbnRlcnZhbFN0YXR1c0JhcklkIiwiYWxlcnQiLCJzZXRDdWJlU2NvcmUiLCJyZXNldFNjb3JlIiwiZ2FtZUFnYWluIiwicG9zc2libGUiLCJpIiwiY2hhckF0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwiaW5uZXJUZXh0IiwidG9VcHBlckNhc2UiLCJwcmVzc0NvcnJlY3RLZXkiLCJhZGRTY29yZSIsInNldE5ld0ludGVydmFsIiwic2l6ZVVwIiwicHJlc3NVbmNvcnJlY3RLZXkiLCJzdWJTY29yZSIsInNldEtleSIsImtleSIsInRleHRDb250ZW50IiwidG9Mb3dlckNhc2UiLCJybmRvbSIsInJhbmRvbU51bWJlciIsImZpbmlzaEdhbWUiLCJ3aW5kb3ciLCJtaW4iLCJtYXgiLCJ3aWR0aCIsInBhcnNlSW50Iiwic3R5bGUiLCJoZWlnaHQiLCJ0b1N0cmluZyIsInN0cmluZyJdLCJtYXBwaW5ncyI6IkNBcU9hLElBcE9iLFdBU0UsV0FDVUEsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsUUFSQSxJQUFBUixNQUFlUyxTQUFTQyxjQUFjLHNCQUN0QyxJQUFBVCxNQUFjUSxTQUFTQyxjQUFjLHFCQUNyQyxJQUFBUixNQUFtQk8sU0FBU0MsY0FBYywyQkFDMUMsSUFBQVAsTUFBYU0sU0FBU0MsY0FBYyxvQkFDcEMsSUFBQU4sTUFBcUJLLFNBQVNDLGNBQWMsNkJBQzVDLElBQUFMLE1BQVdJLFNBQVNDLGNBQWMsMEJBQ2xDLElBQUFKLE1BQVVHLFNBQVNDLGNBQWMseUJBQ2pDLElBQUFILE1BQVdFLFNBQVNDLGNBQWMsMEJBQ2xDLElBQUFGLE1BQVNDLFNBQVNFLGVBQWUsUUFSakMsS0FBQVgsZUFDQSxLQUFBQyxjQUNBLEtBQUFDLG1CQUNBLEtBQUFDLGFBQ0EsS0FBQUMscUJBQ0EsS0FBQUMsV0FDQSxLQUFBQyxVQUNBLEtBQUFDLFdBQ0EsS0FBQUMsU0FqQkYsS0FBQUksV0FBcUIsR0FDckIsS0FBQUMsTUFBZ0IsSUFHaEIsS0FBQUMsV0FBcUIsRUFDckIsS0FBQUMsaUJBQTJCLEVBNE5yQyxPQTdNRSxZQUFBQyxNQUFBLFdBQ0VDLEtBQUtDLG9CQUNMRCxLQUFLRSxzQkFDTEYsS0FBS0csMkJBQ0xILEtBQUtJLDBCQUNMSixLQUFLSyw0QkFHQyxZQUFBRix5QkFBUixzQkFDRUgsS0FBS1osU0FBU2tCLGlCQUFpQixTQUFTLFlBQ2pCLElBQW5CLEVBQUtULFlBQ1AsRUFBS1UsWUFBYyxFQUNuQixFQUFLQyxjQUNMLEVBQUtyQixtQkFBbUJzQixVQUFVQyxPQUFPLFVBQ3pDQyxjQUFjLEVBQUtDLFlBQ25CLEVBQUtBLFdBQWFDLGFBQVksV0FDNUIsRUFBS0MsY0FBYyxFQUFLbEIsT0FDeEIsRUFBS21CLFdBQ0wsRUFB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QU0sNEJBQ05sQixLQUFLcUIsYUFFSHJCLEtBQUtKLE9BQVMsSUFDaEJzQixNQUFNLDJCQUNObEIsS0FBS3FCLGNBSUQsWUFBQUYsYUFBUixTQUFxQnZCLEdBQ25CLE9BQU9JLEtBQUtmLGlCQUFpQjRDLFVBQVlqQyxFQUFNdUQsWUFHekMsWUFBQS9CLFdBQVIsU0FBbUJnQyxHQUNsQixPQUFPcEQsS0FBS2pCLGFBQWE4QyxVQUFZdUIsR0FFeEMsRUFsT0EsS0FzT0tyRCIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmNsYXNzIEdhbWUge1xuICBwcml2YXRlIGN1cnJlbnRLZXk6IHN0cmluZyA9ICcnO1xuICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAxMDA7XG4gIHByaXZhdGUgaW50ZXJ2YWxJZDogTm9kZUpTLlRpbWVvdXQ7XG4gIHByaXZhdGUgaW50ZXJ2YWxTdGF0dXNCYXJJZDogTm9kZUpTLlRpbWVvdXQ7XG4gIHByaXZhdGUgZ2FtZVN0YXRlOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgdGltZXJQcm9ncmVzc0JhcjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBzcXVhcmVXaWR0aDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgc2NvcmVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtc2NvcmVdJykgYXMgSFRNTEhlYWRpbmdFbGVtZW50LFxuICAgIHByaXZhdGUgY3ViZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jdWJlXScpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgIHByaXZhdGUgY3ViZVNjb3JlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWN1YmUtc2NvcmVdJykgYXMgSFRNTERpdkVsZW1lbnQsXG4gICAgcHJpdmF0ZSBrZXlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEta2V5XScpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgcHJpdmF0ZSBwcm9ncmVzc0JhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wcm9ncmVzcy1iYXJdJykgYXMgSFRNTEVsZW1lbnQsXG4gICAgcHJpdmF0ZSBrZXlTdGFydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWtleS1zdGFydF0nKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICBwcml2YXRlIGtleVN0b3AgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1rZXktc3RvcF0nKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICBwcml2YXRlIGtleUFnYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEta2V5LWFnYWluXScpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgIHByaXZhdGUgc3F1YXJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJib3hcIikgYXMgSFRNTEVsZW1lbnQsXG4gICkgeyB9XG5cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5yYW5kb21LZXlJbnRlcnZhbCgpXG4gICAgdGhpcy5zdWJzY3JpYmVPbktleVByZXNzKClcbiAgICB0aGlzLnN1YnNjcmliZU9uS2V5U3RhcnRDbGljaygpO1xuICAgIHRoaXMuc3Vic2NyaWJlT25LZXlTdG9wQ2xpY2soKTtcbiAgICB0aGlzLnN1YnNjcmliZU9uS2V5QWdhaW5DbGljaygpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdWJzY3JpYmVPbktleVN0YXJ0Q2xpY2soKTogdm9pZCB7XG4gICAgdGhpcy5rZXlTdGFydC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpOiB2b2lkID0+IHtcbiAgICBpZiAodGhpcy5nYW1lU3RhdGUgPT09IGZhbHNlKSB7XG4gICAgICB0aGlzLnNxdWFyZVdpZHRoID0gMTtcbiAgICAgIHRoaXMucHJvZ3Jlc3NCYXIoKTtcbiAgICAgIHRoaXMucHJvZ3Jlc3NCYXJFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xuICAgICAgdGhpcy5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICB0aGlzLnN1YlNjb3JlVGltZXIodGhpcy5zY29yZSk7XG4gICAgICAgIHRoaXMuc2l6ZURvd24oKTtcbiAgICAgICAgdGhpcy5zcXVhcmVXaWR0aCA9IDE7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIoKTtcbiAgICAgIH0sIDMwMDApO1xuICAgIH1cbiAgICB0aGlzLmdhbWVTdGF0ZSA9IHRydWU7XG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgc3Vic2NyaWJlT25LZXlTdG9wQ2xpY2soKTogdm9pZCB7XG4gICAgdGhpcy5rZXlTdG9wLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk6IHZvaWQgPT4ge1xuICAgIHRoaXMuZ2FtZVN0YXRlID0gZmFsc2U7XG4gICAgdGhpcy5wcm9ncmVzc0JhckVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsU3RhdHVzQmFySWQpO1xuICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDA7XG4gICAgdGhpcy5zcXVhcmVXaWR0aCA9IDk5O1xuICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcbiAgICBhbGVydCgneW91ciBTY29yZTonICsgdGhpcy5zY29yZSk7XG4gICAgdGhpcy5zY29yZSA9IDEwMDtcbiAgICB0aGlzLnNldEN1YmVTY29yZSh0aGlzLnNjb3JlKTtcbiAgICB0aGlzLnJlc2V0U2NvcmUoJycpO1xuICAgIH0pXG4gIH1cbiAgcHJpdmF0ZSBzdWJzY3JpYmVPbktleUFnYWluQ2xpY2soKTogdm9pZCB7XG4gICAgdGhpcy5rZXlBZ2Fpbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpOiB2b2lkID0+IHtcbiAgICB0aGlzLmdhbWVBZ2FpbigpXG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgZ2FtZUFnYWluKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmdhbWVTdGF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5zY29yZSA9IDEwMDtcbiAgICAgIHRoaXMuc3F1YXJlV2lkdGggPSAxO1xuICAgICAgdGhpcy5wcm9ncmVzc0JhcigpO1xuICAgICAgdGhpcy5zZXRDdWJlU2NvcmUodGhpcy5zY29yZSk7XG4gICAgICB0aGlzLnJlc2V0U2NvcmUoJycpO1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xuICAgICAgdGhpcy5pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICB0aGlzLnN1YlNjb3JlVGltZXIodGhpcy5zY29yZSk7XG4gICAgICAgIHRoaXMuc2l6ZURvd24oKTtcbiAgICAgICAgdGhpcy5zcXVhcmVXaWR0aCA9IDE7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIoKTtcbiAgICAgIH0sIDMwMDApO1xuICAgICAgdGhpcy5nYW1lU3RhdGUgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmFuZG9tS2V5SW50ZXJ2YWwoKTogdm9pZCB7XG4gICAgbGV0IHBvc3NpYmxlOiBzdHJpbmcgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoxMjM0NTY3ODkwXCI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxOyBpKyspIHtcbiAgICAgIHRoaXMuY3VycmVudEtleSA9IHBvc3NpYmxlLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZS5sZW5ndGgpKTtcbiAgICAgIHRoaXMua2V5RWxlbWVudC5pbm5lclRleHQgPSB0aGlzLmN1cnJlbnRLZXkudG9VcHBlckNhc2UoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHByZXNzQ29ycmVjdEtleSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5nYW1lU3RhdGUgPT09IHRydWUpIHtcbiAgICAgIHRoaXMucmFuZG9tS2V5SW50ZXJ2YWwoKTtcbiAgICAgIHRoaXMuYWRkU2NvcmUoKTtcbiAgICAgIHRoaXMuc2V0TmV3SW50ZXJ2YWwoKTtcbiAgICAgIHRoaXMuc2l6ZVVwKCk7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxTdGF0dXNCYXJJZCk7XG4gICAgICB0aGlzLnNxdWFyZVdpZHRoID0gMTtcbiAgICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDA7XG4gICAgICB0aGlzLnByb2dyZXNzQmFyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KCdQbGVhc2UgcHJlc3MgXCJTdGFydFwiJyk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBwcmVzc1VuY29ycmVjdEtleSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5nYW1lU3RhdGUgPT09IHRydWUpIHtcbiAgICAgIHRoaXMuc3ViU2NvcmUoKTtcbiAgICAgIHRoaXMucmFuZG9tS2V5SW50ZXJ2YWwoKTtcbiAgICAgIHRoaXMuc2V0TmV3SW50ZXJ2YWwoKTtcbiAgICAgIHRoaXMuc2l6ZURvd24oKTtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbFN0YXR1c0JhcklkKTtcbiAgICAgIHRoaXMuc3F1YXJlV2lkdGggPSAxO1xuICAgICAgdGhpcy50aW1lclByb2dyZXNzQmFyID0gMDtcbiAgICAgIHRoaXMucHJvZ3Jlc3NCYXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoJ1BsZWFzZSBwcmVzcyBcIlN0YXJ0XCInKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldEtleShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmIChrZXkgPT09IHRoaXMua2V5RWxlbWVudC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICB0aGlzLnByZXNzQ29ycmVjdEtleSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByZXNzVW5jb3JyZWN0S2V5KCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXROZXdJbnRlcnZhbCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5nYW1lU3RhdGUgPT09IHRydWUpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcbiAgICAgIHRoaXMuaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgdGhpcy5zdWJTY29yZVRpbWVyKHRoaXMuc2NvcmUpO1xuICAgICAgICB0aGlzLnNpemVEb3duKCk7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbFN0YXR1c0JhcklkKTtcbiAgICAgICAgdGhpcy5zcXVhcmVXaWR0aCA9IDE7XG4gICAgICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDA7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIoKTtcbiAgICAgIH0sIDMwMDApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYWRkU2NvcmUoKTogdm9pZCB7XG4gICAgbGV0IHJuZG9tOiBudW1iZXIgPSB0aGlzLnJhbmRvbU51bWJlcig1LCAxMClcbiAgICB0aGlzLnNjb3JlID0gdGhpcy5zY29yZSArIHJuZG9tO1xuICAgIHRoaXMuc2V0Q3ViZVNjb3JlKHRoaXMuc2NvcmUpO1xuICAgIHRoaXMuc2NvcmVFbGVtZW50LmlubmVyVGV4dCA9IGArJHtybmRvbX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBzdWJTY29yZSgpOiB2b2lkIHtcbiAgICBsZXQgcm5kb206IG51bWJlciA9IHRoaXMucmFuZG9tTnVtYmVyKDIwLCAyNSk7XG4gICAgdGhpcy5zY29yZSA9IHRoaXMuc2NvcmUgLSBybmRvbTtcbiAgICB0aGlzLnNldEN1YmVTY29yZSh0aGlzLnNjb3JlKTtcbiAgICB0aGlzLnNjb3JlRWxlbWVudC5pbm5lclRleHQgPSBgLSR7cm5kb219YDtcbiAgfVxuXG4gIHByaXZhdGUgc3ViU2NvcmVUaW1lcihzY29yZTogbnVtYmVyKTogdm9pZCB7XG4gICAgbGV0IHJuZG9tOiBudW1iZXIgPSB0aGlzLnJhbmRvbU51bWJlcigxMCwgMTUpO1xuICAgIHRoaXMuc2NvcmUgPSB0aGlzLnNjb3JlIC0gcm5kb207XG4gICAgdGhpcy5maW5pc2hHYW1lKCk7XG4gICAgdGhpcy5zZXRDdWJlU2NvcmUodGhpcy5zY29yZSk7XG4gICAgdGhpcy5zY29yZUVsZW1lbnQuaW5uZXJUZXh0ID0gYC0ke3JuZG9tfWA7XG4gIH1cblxuICBwcml2YXRlIHN1YnNjcmliZU9uS2V5UHJlc3MoKTogdm9pZCB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGtleSkgPT4ge1xuICAgICAgdGhpcy5zZXRLZXkoa2V5LmtleSk7XG4gICAgICB0aGlzLmZpbmlzaEdhbWUoKTtcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSByYW5kb21OdW1iZXIobWluOiBudW1iZXIsIG1heDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gIH1cblxuICBwcml2YXRlIHNpemVVcCgpOiB2b2lkIHtcbiAgICBsZXQgd2lkdGg6IG51bWJlciA9IHBhcnNlSW50KHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoKTtcbiAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSBwYXJzZUludCh0aGlzLnNxdWFyZS5zdHlsZS5oZWlnaHQpO1xuICAgIHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoID0gKHdpZHRoICsgMykgKyBcInB4XCI7XG4gICAgdGhpcy5zcXVhcmUuc3R5bGUuaGVpZ2h0ID0gKGhlaWdodCArIDMpICsgXCJweFwiO1xuICB9XG5cbiAgcHJpdmF0ZSBzaXplRG93bigpOiB2b2lkIHtcbiAgICBsZXQgd2lkdGg6IG51bWJlciA9IHBhcnNlSW50KHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoKTtcbiAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSBwYXJzZUludCh0aGlzLnNxdWFyZS5zdHlsZS5oZWlnaHQpO1xuICAgIHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoID0gKHdpZHRoIC0gMikgKyBcInB4XCI7XG4gICAgdGhpcy5zcXVhcmUuc3R5bGUuaGVpZ2h0ID0gKGhlaWdodCAtIDIpICsgXCJweFwiO1xuICB9XG5cbiAgcHJpdmF0ZSBwcm9ncmVzc0JhcigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lclByb2dyZXNzQmFyID09IDApIHtcbiAgICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDE7XG4gICAgICB0aGlzLnNxdWFyZVdpZHRoID0gMTtcbiAgICAgIHRoaXMuaW50ZXJ2YWxTdGF0dXNCYXJJZCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3F1YXJlV2lkdGggPj0gMTAwKSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsU3RhdHVzQmFySWQpO1xuICAgICAgICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zcXVhcmVXaWR0aCsrO1xuICAgICAgICAgIHRoaXMucHJvZ3Jlc3NCYXJFbGVtZW50LnN0eWxlLndpZHRoID0gdGhpcy5zcXVhcmVXaWR0aCArIFwiJVwiO1xuICAgICAgICB9XG4gICAgICB9LCAzMCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmaW5pc2hHYW1lKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNjb3JlID49IDIwMCkge1xuICAgICAgYWxlcnQoJ1lvdSBXT04hIFlvdXIgU2NvcmU6IDIwMCcpO1xuICAgICAgdGhpcy5nYW1lQWdhaW4oKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc2NvcmUgPD0gMCkge1xuICAgICAgYWxlcnQoJ1RyeSBBZ2FpbiEgWW91ciBTY29yZTowJyk7XG4gICAgICB0aGlzLmdhbWVBZ2FpbigpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0Q3ViZVNjb3JlKHNjb3JlOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5jdWJlU2NvcmVFbGVtZW50LmlubmVyVGV4dCA9IHNjb3JlLnRvU3RyaW5nKCk7XG4gIH1cblxuICBwcml2YXRlIHJlc2V0U2NvcmUoc3RyaW5nOiBzdHJpbmcpIHtcbiAgIHJldHVybiB0aGlzLnNjb3JlRWxlbWVudC5pbm5lclRleHQgPSBzdHJpbmc7XG4gIH1cbn1cblxuY29uc3QgZ2FtZSA9IG5ldyBHYW1lKCk7XG5cbmdhbWUuc3RhcnQoKTsiXSwic291cmNlUm9vdCI6IiJ9