(()=>{var e=document.querySelector("[data-score]"),t=document.querySelector("[data-cube]"),r=document.querySelector("[data-cube-score]"),s=document.querySelector("[data-key]"),i=document.querySelector("[data-progress-bar]"),a=document.querySelector("[data-key-start]"),o=document.querySelector("[data-key-stop]"),n=document.querySelector("[data-key-again]"),h=document.getElementById("box");new(function(){function t(e,t,r,s,i,a,o,n,h){this.scoreElement=e,this.cubeScoreElement=t,this.keyElement=r,this.cubeElement=s,this.progressBarElement=i,this.square=a,this.keyStart=o,this.keyStop=n,this.keyAgain=h,this.currentKey="",this.score=100,this.gameState=!1,this.timerProgressBar=0}return t.prototype.start=function(){var e=this;this.randomKeyInterval(),this.subscribeOnKeyPress(),this.keyStart.addEventListener("click",(function(){e.subscribeOnKeyStartClick()})),this.keyStop.addEventListener("click",(function(){e.subscribeOnKeyStopClick()})),this.keyAgain.addEventListener("click",(function(){e.subscribeOnKeyAgainClick()}))},t.prototype.subscribeOnKeyStartClick=function(){var e=this;!1===this.gameState&&(this.squareWidth=1,this.progressBar(),this.progressBarElement.classList.remove("hidden"),clearInterval(this.intervalId),this.intervalId=setInterval((function(){e.subScoreTimer(e.score),e.sizeDown(),e.squareWidth=1,e.progressBar()}),3e3)),this.gameState=!0},t.prototype.subscribeOnKeyStopClick=function(){this.gameState=!1,this.progressBarElement.classList.add("hidden"),clearInterval(this.intervalStatusBarId),this.timerProgressBar=0,this.squareWidth=99,clearInterval(this.intervalId),alert("your Score:"+this.score),this.score=100,this.setCubeScore(this.score),this.resetScore("")},t.prototype.subscribeOnKeyAgainClick=function(){var e=this;!0===this.gameState&&(this.score=100,this.squareWidth=1,this.progressBar(),this.setCubeScore(this.score),this.resetScore(""),clearInterval(this.intervalId),this.intervalId=setInterval((function(){e.subScoreTimer(e.score),e.sizeDown(),e.squareWidth=1,e.progressBar()}),3e3),this.gameState=!0)},t.prototype.randomKeyInterval=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",t=0;t<1;t++)this.currentKey=e.charAt(Math.floor(Math.random()*e.length));s.innerText=this.currentKey.toUpperCase()},t.prototype.pressCorrectKey=function(){!0===this.gameState?(this.randomKeyInterval(),this.addScore(),this.setNewInterval(),this.sizeUp(),clearInterval(this.intervalStatusBarId),this.squareWidth=1,this.timerProgressBar=0,this.progressBar()):alert('Please press "Start"')},t.prototype.pressUncorrectKey=function(){!0===this.gameState?(this.subScore(),this.randomKeyInterval(),this.setNewInterval(),this.sizeDown(),clearInterval(this.intervalStatusBarId),this.squareWidth=1,this.timerProgressBar=0,this.progressBar()):alert('Please press "Start"')},t.prototype.setKey=function(e){e===s.textContent.toLowerCase()?this.pressCorrectKey():this.pressUncorrectKey()},t.prototype.setNewInterval=function(){var e=this;!0===this.gameState&&(clearInterval(this.intervalId),this.intervalId=setInterval((function(){e.subScoreTimer(e.score),e.sizeDown(),clearInterval(e.intervalStatusBarId),e.squareWidth=1,e.timerProgressBar=0,e.progressBar()}),3e3))},t.prototype.addScore=function(){var t=this.randomNumber(5,10);this.score=this.score+t,this.setCubeScore(this.score),e.innerText="+"+t},t.prototype.subScore=function(){var t=this.randomNumber(20,25);this.score=this.score-t,this.setCubeScore(this.score),e.innerText="-"+t},t.prototype.subScoreTimer=function(t){var r=this.randomNumber(10,15);this.score=this.score-r,this.finishGame(),this.setCubeScore(this.score),e.innerText="-"+r},t.prototype.subscribeOnKeyPress=function(){var e=this;window.addEventListener("keypress",(function(t){e.setKey(t.key),e.finishGame()}))},t.prototype.randomNumber=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.prototype.sizeUp=function(){var e=parseInt(this.square.style.width),t=parseInt(this.square.style.height);this.square.style.width=e+3+"px",this.square.style.height=t+3+"px"},t.prototype.sizeDown=function(){var e=parseInt(this.square.style.width),t=parseInt(this.square.style.height);this.square.style.width=e-2+"px",this.square.style.height=t-2+"px"},t.prototype.progressBar=function(){var e=this;0==this.timerProgressBar&&(this.timerProgressBar=1,this.squareWidth=1,this.intervalStatusBarId=setInterval((function(){e.squareWidth>=100?(clearInterval(e.intervalStatusBarId),e.timerProgressBar=0):(e.squareWidth++,i.style.width=e.squareWidth+"%")}),30))},t.prototype.finishGame=function(){this.score>=200&&(alert("You WON! Your Score: 200"),this.subscribeOnKeyAgainClick()),this.score<=0&&(alert("Try Again! Your Score:0"),this.subscribeOnKeyAgainClick())},t.prototype.setCubeScore=function(e){return this.cubeScoreElement.innerText=e.toString()},t.prototype.resetScore=function(e){return this.scoreElement.innerText=e},t}())(e,r,s,t,i,h,a,o,n).start()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly82LXR5cGVzY3JpcHQvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsic2NvcmVFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY3ViZUVsZW1lbnQiLCJjdWJlU2NvcmVFbGVtZW50Iiwia2V5RWxlbWVudCIsInByb2dyZXNzQmFyRWxlbWVudCIsImtleVN0YXJ0Iiwia2V5U3RvcCIsImtleUFnYWluIiwic3F1YXJlIiwiZ2V0RWxlbWVudEJ5SWQiLCJjdXJyZW50S2V5Iiwic2NvcmUiLCJnYW1lU3RhdGUiLCJ0aW1lclByb2dyZXNzQmFyIiwic3RhcnQiLCJ0aGlzIiwicmFuZG9tS2V5SW50ZXJ2YWwiLCJzdWJzY3JpYmVPbktleVByZXNzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1YnNjcmliZU9uS2V5U3RhcnRDbGljayIsInN1YnNjcmliZU9uS2V5U3RvcENsaWNrIiwic3Vic2NyaWJlT25LZXlBZ2FpbkNsaWNrIiwic3F1YXJlV2lkdGgiLCJwcm9ncmVzc0JhciIsImNsYXNzTGlzdCIsInJlbW92ZSIsImNsZWFySW50ZXJ2YWwiLCJpbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJzdWJTY29yZVRpbWVyIiwic2l6ZURvd24iLCJhZGQiLCJpbnRlcnZhbFN0YXR1c0JhcklkIiwiYWxlcnQiLCJzZXRDdWJlU2NvcmUiLCJyZXNldFNjb3JlIiwicG9zc2libGUiLCJpIiwiY2hhckF0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwiaW5uZXJUZXh0IiwidG9VcHBlckNhc2UiLCJwcmVzc0NvcnJlY3RLZXkiLCJhZGRTY29yZSIsInNldE5ld0ludGVydmFsIiwic2l6ZVVwIiwicHJlc3NVbmNvcnJlY3RLZXkiLCJzdWJTY29yZSIsInNldEtleSIsImtleSIsInRleHRDb250ZW50IiwidG9Mb3dlckNhc2UiLCJybmRvbSIsInJhbmRvbU51bWJlciIsImZpbmlzaEdhbWUiLCJ3aW5kb3ciLCJtaW4iLCJtYXgi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QnlDLFVBQVloQyxFQUFNc0QsWUFHekMsWUFBQTlCLFdBQVIsU0FBbUIrQixHQUNsQixPQUFPbkQsS0FBS2pCLGFBQWE2QyxVQUFZdUIsR0FFeEMsRUFoT0EsR0FrT2EsQ0FBU3BFLEVBQWNJLEVBQWtCQyxFQUFZRixFQUFhRyxFQUFvQkksRUFBUUgsRUFBVUMsRUFBU0MsR0FFekhPLFMiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2NvcmVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtc2NvcmVdJykgYXMgSFRNTEhlYWRpbmdFbGVtZW50O1xuY29uc3QgY3ViZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jdWJlXScpIGFzIEhUTUxEaXZFbGVtZW50O1xuY29uc3QgY3ViZVNjb3JlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWN1YmUtc2NvcmVdJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5jb25zdCBrZXlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEta2V5XScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5jb25zdCBwcm9ncmVzc0JhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wcm9ncmVzcy1iYXJdJykgYXMgSFRNTEVsZW1lbnQ7XG5jb25zdCBrZXlTdGFydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWtleS1zdGFydF0nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbmNvbnN0IGtleVN0b3AgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1rZXktc3RvcF0nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbmNvbnN0IGtleUFnYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEta2V5LWFnYWluXScpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJib3hcIikgYXMgSFRNTEVsZW1lbnQ7XG5cbmNsYXNzIEdhbWUge1xuICBwcml2YXRlIGN1cnJlbnRLZXk6IHN0cmluZyA9ICcnO1xuICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAxMDA7XG4gIHByaXZhdGUgaW50ZXJ2YWxJZDogTm9kZUpTLlRpbWVvdXQ7XG4gIHByaXZhdGUgaW50ZXJ2YWxTdGF0dXNCYXJJZDogTm9kZUpTLlRpbWVvdXQ7XG4gIHByaXZhdGUgZ2FtZVN0YXRlOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgdGltZXJQcm9ncmVzc0JhcjogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBzcXVhcmVXaWR0aDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgc2NvcmVFbGVtZW50OiBIVE1MSGVhZGluZ0VsZW1lbnQsXG4gICAgcHJpdmF0ZSBjdWJlU2NvcmVFbGVtZW50OiBIVE1MRGl2RWxlbWVudCxcbiAgICBwcml2YXRlIGtleUVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgcHJpdmF0ZSBjdWJlRWxlbWVudD86IEhUTUxEaXZFbGVtZW50LFxuICAgIHByaXZhdGUgcHJvZ3Jlc3NCYXJFbGVtZW50PzogSFRNTEVsZW1lbnQsXG4gICAgcHJpdmF0ZSBzcXVhcmU/OiBIVE1MRWxlbWVudCxcbiAgICBwcml2YXRlIGtleVN0YXJ0PzogSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgcHJpdmF0ZSBrZXlTdG9wPzogSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgcHJpdmF0ZSBrZXlBZ2Fpbj86IEhUTUxCdXR0b25FbGVtZW50XG4gICkgeyB9XG5cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5yYW5kb21LZXlJbnRlcnZhbCgpXG5cbiAgICB0aGlzLnN1YnNjcmliZU9uS2V5UHJlc3MoKVxuXG4gICAgdGhpcy5rZXlTdGFydC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpOiB2b2lkID0+IHtcbiAgICAgIHRoaXMuc3Vic2NyaWJlT25LZXlTdGFydENsaWNrKCk7XG4gICAgfSlcblxuICAgIHRoaXMua2V5U3RvcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpOiB2b2lkID0+IHtcbiAgICAgIHRoaXMuc3Vic2NyaWJlT25LZXlTdG9wQ2xpY2soKTtcbiAgICB9KVxuXG4gICAgdGhpcy5rZXlBZ2Fpbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpOiB2b2lkID0+IHtcbiAgICAgIHRoaXMuc3Vic2NyaWJlT25LZXlBZ2FpbkNsaWNrKCk7XG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgc3Vic2NyaWJlT25LZXlTdGFydENsaWNrKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmdhbWVTdGF0ZSA9PT0gZmFsc2UpIHtcbiAgICAgIHRoaXMuc3F1YXJlV2lkdGggPSAxO1xuICAgICAgdGhpcy5wcm9ncmVzc0JhcigpO1xuICAgICAgdGhpcy5wcm9ncmVzc0JhckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XG4gICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIHRoaXMuc3ViU2NvcmVUaW1lcih0aGlzLnNjb3JlKTtcbiAgICAgICAgdGhpcy5zaXplRG93bigpO1xuICAgICAgICB0aGlzLnNxdWFyZVdpZHRoID0gMTtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0JhcigpO1xuICAgICAgfSwgMzAwMCk7XG4gICAgfVxuICAgIHRoaXMuZ2FtZVN0YXRlID0gdHJ1ZTtcbiAgfVxuXG4gIHByaXZhdGUgc3Vic2NyaWJlT25LZXlTdG9wQ2xpY2soKTogdm9pZCB7XG4gICAgdGhpcy5nYW1lU3RhdGUgPSBmYWxzZTtcbiAgICB0aGlzLnByb2dyZXNzQmFyRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxTdGF0dXNCYXJJZCk7XG4gICAgdGhpcy50aW1lclByb2dyZXNzQmFyID0gMDtcbiAgICB0aGlzLnNxdWFyZVdpZHRoID0gOTk7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsSWQpO1xuICAgIGFsZXJ0KCd5b3VyIFNjb3JlOicgKyB0aGlzLnNjb3JlKTtcbiAgICB0aGlzLnNjb3JlID0gMTAwO1xuICAgIHRoaXMuc2V0Q3ViZVNjb3JlKHRoaXMuc2NvcmUpO1xuICAgIHRoaXMucmVzZXRTY29yZSgnJyk7XG4gIH1cbiAgcHJpdmF0ZSBzdWJzY3JpYmVPbktleUFnYWluQ2xpY2soKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZ2FtZVN0YXRlID09PSB0cnVlKSB7XG4gICAgICB0aGlzLnNjb3JlID0gMTAwO1xuICAgICAgdGhpcy5zcXVhcmVXaWR0aCA9IDE7XG4gICAgICB0aGlzLnByb2dyZXNzQmFyKCk7XG4gICAgICB0aGlzLnNldEN1YmVTY29yZSh0aGlzLnNjb3JlKTtcbiAgICAgIHRoaXMucmVzZXRTY29yZSgnJyk7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XG4gICAgICB0aGlzLmludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIHRoaXMuc3ViU2NvcmVUaW1lcih0aGlzLnNjb3JlKTtcbiAgICAgICAgdGhpcy5zaXplRG93bigpO1xuICAgICAgICB0aGlzLnNxdWFyZVdpZHRoID0gMTtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0JhcigpO1xuICAgICAgfSwgMzAwMCk7XG4gICAgICB0aGlzLmdhbWVTdGF0ZSA9IHRydWU7XG4gICAgfVxuICB9XG4gIHByaXZhdGUgcmFuZG9tS2V5SW50ZXJ2YWwoKTogdm9pZCB7XG4gICAgbGV0IHBvc3NpYmxlOiBzdHJpbmcgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoxMjM0NTY3ODkwXCI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxOyBpKyspXG4gICAgICB0aGlzLmN1cnJlbnRLZXkgPSBwb3NzaWJsZS5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGUubGVuZ3RoKSk7XG4gICAga2V5RWxlbWVudC5pbm5lclRleHQgPSB0aGlzLmN1cnJlbnRLZXkudG9VcHBlckNhc2UoKTtcbiAgfVxuXG4gIHByaXZhdGUgcHJlc3NDb3JyZWN0S2V5KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmdhbWVTdGF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5yYW5kb21LZXlJbnRlcnZhbCgpO1xuICAgICAgdGhpcy5hZGRTY29yZSgpO1xuICAgICAgdGhpcy5zZXROZXdJbnRlcnZhbCgpO1xuICAgICAgdGhpcy5zaXplVXAoKTtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbFN0YXR1c0JhcklkKTtcbiAgICAgIHRoaXMuc3F1YXJlV2lkdGggPSAxO1xuICAgICAgdGhpcy50aW1lclByb2dyZXNzQmFyID0gMDtcbiAgICAgIHRoaXMucHJvZ3Jlc3NCYXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoJ1BsZWFzZSBwcmVzcyBcIlN0YXJ0XCInKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHByZXNzVW5jb3JyZWN0S2V5KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmdhbWVTdGF0ZSA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5zdWJTY29yZSgpO1xuICAgICAgdGhpcy5yYW5kb21LZXlJbnRlcnZhbCgpO1xuICAgICAgdGhpcy5zZXROZXdJbnRlcnZhbCgpO1xuICAgICAgdGhpcy5zaXplRG93bigpO1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsU3RhdHVzQmFySWQpO1xuICAgICAgdGhpcy5zcXVhcmVXaWR0aCA9IDE7XG4gICAgICB0aGlzLnRpbWVyUHJvZ3Jlc3NCYXIgPSAwO1xuICAgICAgdGhpcy5wcm9ncmVzc0JhcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydCgnUGxlYXNlIHByZXNzIFwiU3RhcnRcIicpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0S2V5KGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKGtleSA9PT0ga2V5RWxlbWVudC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICB0aGlzLnByZXNzQ29ycmVjdEtleSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByZXNzVW5jb3JyZWN0S2V5KCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXROZXdJbnRlcnZhbCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5nYW1lU3RhdGUgPT09IHRydWUpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbElkKTtcbiAgICAgIHRoaXMuaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgdGhpcy5zdWJTY29yZVRpbWVyKHRoaXMuc2NvcmUpO1xuICAgICAgICB0aGlzLnNpemVEb3duKCk7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbFN0YXR1c0JhcklkKTtcbiAgICAgICAgdGhpcy5zcXVhcmVXaWR0aCA9IDE7XG4gICAgICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDA7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIoKTtcbiAgICAgIH0sIDMwMDApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYWRkU2NvcmUoKTogdm9pZCB7XG4gICAgbGV0IHJuZG9tOiBudW1iZXIgPSB0aGlzLnJhbmRvbU51bWJlcig1LCAxMClcbiAgICB0aGlzLnNjb3JlID0gdGhpcy5zY29yZSArIHJuZG9tO1xuICAgIHRoaXMuc2V0Q3ViZVNjb3JlKHRoaXMuc2NvcmUpO1xuICAgIHNjb3JlRWxlbWVudC5pbm5lclRleHQgPSBgKyR7cm5kb219YDtcbiAgfVxuXG4gIHByaXZhdGUgc3ViU2NvcmUoKTogdm9pZCB7XG4gICAgbGV0IHJuZG9tOiBudW1iZXIgPSB0aGlzLnJhbmRvbU51bWJlcigyMCwgMjUpO1xuICAgIHRoaXMuc2NvcmUgPSB0aGlzLnNjb3JlIC0gcm5kb207XG4gICAgdGhpcy5zZXRDdWJlU2NvcmUodGhpcy5zY29yZSk7XG4gICAgc2NvcmVFbGVtZW50LmlubmVyVGV4dCA9IGAtJHtybmRvbX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBzdWJTY29yZVRpbWVyKHNjb3JlOiBudW1iZXIpOiB2b2lkIHtcbiAgICBsZXQgcm5kb206IG51bWJlciA9IHRoaXMucmFuZG9tTnVtYmVyKDEwLCAxNSk7XG4gICAgdGhpcy5zY29yZSA9IHRoaXMuc2NvcmUgLSBybmRvbTtcbiAgICB0aGlzLmZpbmlzaEdhbWUoKTtcbiAgICB0aGlzLnNldEN1YmVTY29yZSh0aGlzLnNjb3JlKTtcbiAgICBzY29yZUVsZW1lbnQuaW5uZXJUZXh0ID0gYC0ke3JuZG9tfWA7XG4gIH1cblxuICBwcml2YXRlIHN1YnNjcmliZU9uS2V5UHJlc3MoKTogdm9pZCB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGtleSkgPT4ge1xuICAgICAgdGhpcy5zZXRLZXkoa2V5LmtleSk7XG4gICAgICB0aGlzLmZpbmlzaEdhbWUoKTtcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSByYW5kb21OdW1iZXIobWluOiBudW1iZXIsIG1heDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gIH1cblxuICBwcml2YXRlIHNpemVVcCgpOiB2b2lkIHtcbiAgICBsZXQgd2lkdGg6IG51bWJlciA9IHBhcnNlSW50KHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoKTtcbiAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSBwYXJzZUludCh0aGlzLnNxdWFyZS5zdHlsZS5oZWlnaHQpO1xuICAgIHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoID0gKHdpZHRoICsgMykgKyBcInB4XCI7XG4gICAgdGhpcy5zcXVhcmUuc3R5bGUuaGVpZ2h0ID0gKGhlaWdodCArIDMpICsgXCJweFwiO1xuICB9XG5cbiAgcHJpdmF0ZSBzaXplRG93bigpOiB2b2lkIHtcbiAgICBsZXQgd2lkdGg6IG51bWJlciA9IHBhcnNlSW50KHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoKTtcbiAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSBwYXJzZUludCh0aGlzLnNxdWFyZS5zdHlsZS5oZWlnaHQpO1xuICAgIHRoaXMuc3F1YXJlLnN0eWxlLndpZHRoID0gKHdpZHRoIC0gMikgKyBcInB4XCI7XG4gICAgdGhpcy5zcXVhcmUuc3R5bGUuaGVpZ2h0ID0gKGhlaWdodCAtIDIpICsgXCJweFwiO1xuICB9XG5cbiAgcHJpdmF0ZSBwcm9ncmVzc0JhcigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy50aW1lclByb2dyZXNzQmFyID09IDApIHtcbiAgICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDE7XG4gICAgICB0aGlzLnNxdWFyZVdpZHRoID0gMTtcbiAgICAgIHRoaXMuaW50ZXJ2YWxTdGF0dXNCYXJJZCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3F1YXJlV2lkdGggPj0gMTAwKSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsU3RhdHVzQmFySWQpO1xuICAgICAgICAgIHRoaXMudGltZXJQcm9ncmVzc0JhciA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zcXVhcmVXaWR0aCsrO1xuICAgICAgICAgIHByb2dyZXNzQmFyRWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMuc3F1YXJlV2lkdGggKyBcIiVcIjtcbiAgICAgICAgfVxuICAgICAgfSwgMzApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZmluaXNoR2FtZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zY29yZSA+PSAyMDApIHtcbiAgICAgIGFsZXJ0KCdZb3UgV09OISBZb3VyIFNjb3JlOiAyMDAnKTtcbiAgICAgIHRoaXMuc3Vic2NyaWJlT25LZXlBZ2FpbkNsaWNrKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnNjb3JlIDw9IDApIHtcbiAgICAgIGFsZXJ0KCdUcnkgQWdhaW4hIFlvdXIgU2NvcmU6MCcpO1xuICAgICAgdGhpcy5zdWJzY3JpYmVPbktleUFnYWluQ2xpY2soKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldEN1YmVTY29yZShzY29yZTogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHRoaXMuY3ViZVNjb3JlRWxlbWVudC5pbm5lclRleHQgPSBzY29yZS50b1N0cmluZygpO1xuICB9XG5cbiAgcHJpdmF0ZSByZXNldFNjb3JlKHN0cmluZzogc3RyaW5nKSB7XG4gICByZXR1cm4gdGhpcy5zY29yZUVsZW1lbnQuaW5uZXJUZXh0ID0gc3RyaW5nO1xuICB9XG59XG5cbmNvbnN0IGdhbWUgPSBuZXcgR2FtZShzY29yZUVsZW1lbnQsIGN1YmVTY29yZUVsZW1lbnQsIGtleUVsZW1lbnQsIGN1YmVFbGVtZW50LCBwcm9ncmVzc0JhckVsZW1lbnQsIHNxdWFyZSwga2V5U3RhcnQsIGtleVN0b3AsIGtleUFnYWluKTtcblxuZ2FtZS5zdGFydCgpOyJdLCJzb3VyY2VSb290IjoiIn0=