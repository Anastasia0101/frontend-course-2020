(()=>{"use strict";var t=document.querySelector("[data-score]"),e=document.querySelector("[data-cube-score]"),n=document.querySelector("[data-cube]"),i=document.querySelector("[data-key]"),s=document.querySelector("[data-notification]"),o=document.querySelector("[data-progress-top]"),r=document.querySelector("[data-progress-right]"),a=document.querySelector("[data-progress-left]"),c=document.querySelector("[data-progress-bottom]"),h=document.querySelector("[data-start]"),l=document.querySelector("[data-stop]"),m=document.querySelector("[data-new]"),u=new(function(){function h(t,e,n,i,s,o,r,a){this.scoreElement=t,this.cubeScoreElement=e,this.cubeElement=n,this.keyElement=i,this.progressBottom=s,this.progressLeft=o,this.progressTop=r,this.progressRight=a,this.interval=2e3,this.animationInterval=480,this.characters="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",this.charactersLength=this.characters.length,this.randomCharacters="",this.isKeyPress=!1}return h.prototype.start=function(){this.textAnimate(),this.cyclProgressAnimation(),document.addEventListener("keydown",this.submitting.bind(this)),s.textContent=""},h.prototype.stopGame=function(){i.textContent="",s.textContent="",this.stopAnimation(),this.stoppingTimers(),document.removeEventListener("keydown",this.submitting.bind(this))},h.prototype.restart=function(){t.textContent="100",e.textContent="0",n.style.width="100px",n.style.height="100px",this.stopGame()},h.prototype.textAnimate=function(){this.textTimer=setTimeout((function(){s.textContent="1"}),500),this.textTimer=setTimeout((function(){s.textContent="2"}),1e3),this.textTimer=setTimeout((function(){s.textContent="3"}),1500),this.textTimer=setTimeout((function(){s.textContent="Start typing!"}),2e3),this.textTimer=setTimeout((function(){s.textContent=""}),3e3)},h.prototype.cyclProgressAnimation=function(){var t=this;this.animationTimer=setInterval((function(){t.startAnimation()}),this.interval)},h.prototype.generateLetter=function(){var t=Math.floor(Math.random()*this.charactersLength+1);this.randomCharacters=this.characters[t-1],i.textContent=this.randomCharacters},h.prototype.checkingScore=function(e){e>200?(this.stopGame(),t.textContent="You Win!"):e<0&&(this.stopGame(),t.textContent="You Lose!")},h.prototype.ganeratePoint=function(i){if(i){var s=5,o=10,r=Math.floor(Math.random()*(o-s+1)+s);e.textContent="+"+r;var a=parseInt(t.textContent);t.textContent=""+(a+r);var c=parseInt(getComputedStyle(n).width);n.style.width=c+r+"px",n.style.height=c+r+"px"}else{s=void 0,o=void 0,this.isKeyPress?(s=20,o=25):(s=10,o=15),r=Math.floor(Math.random()*(o-s+1)+s),e.textContent="-"+r,a=parseInt(t.textContent),t.textContent=""+(a-r);var h=(c=parseInt(getComputedStyle(n).width))-r;n.style.width=h+"px",n.style.height=h+"px",this.checkingScore(h),this.isKeyPress=!1}},h.prototype.stopAnimation=function(){c.style.transition="none",a.style.transition="none",o.style.transition="none",r.style.transition="none",c.style.width="0",a.style.height="0",o.style.width="0",r.style.height="0",setTimeout((function(){c.style.transition=".48s all linear",a.style.transition=".48s all linear",o.style.transition=".48s all linear",r.style.transition=".48s all linear"}),40)},h.prototype.startAnimation=function(){var t=this;i.classList.replace("hidden","animated"),i.classList.replace("hidden-animated","animated"),this.generateLetter(),new Promise((function(t,e){c.style.width="100%",t()})).then((function(){return new Promise((function(e,n){t.timerleft=setTimeout((function(){a.style.height="100%",e()}),t.animationInterval)}))})).then((function(){return new Promise((function(e,n){t.timerTop=setTimeout((function(){o.style.width="100%",e()}),t.animationInterval)}))})).then((function(){return new Promise((function(e,n){t.timerRight=setTimeout((function(){i.classList.replace("animated-onPress","hidden-animated"),i.classList.replace("animated","hidden-animated"),r.style.height="100%",e()}),t.animationInterval)}))})).then((function(){return new Promise((function(e,n){t.disableAnimation=setTimeout((function(){t.stopAnimation(),t.ganeratePoint(!1),e()}),t.animationInterval)}))}))},h.prototype.stoppingTimers=function(){clearInterval(this.disableAnimation),clearInterval(this.animationTimer),clearInterval(this.timerRight),clearInterval(this.timerTop),clearInterval(this.timerleft)},h.prototype.restartCycle=function(){var t=this;i.textContent="",i.classList.contains("animated-onPress")?i.classList.replace("animated-onPress","animated"):i.classList.replace("animated","animated-onPress"),this.stopAnimation(),setTimeout((function(){t.stoppingTimers(),t.startAnimation(),t.cyclProgressAnimation()}),50)},h.prototype.submitting=function(t){t.key===this.randomCharacters.toLocaleLowerCase()?(this.restartCycle(),this.ganeratePoint(!0)):(this.isKeyPress=!0,this.restartCycle(),this.ganeratePoint(!1))},h}())(t,e,n,i,c,a,o,r);h.addEventListener("click",(function(){u.start(),h.disabled=!0,setTimeout((function(){return l.disabled=!1}),2e3)})),l.addEventListener("click",(function(){h.disabled=!1,l.disabled=!0,u.stopGame()})),m.addEventListener("click",(function(){l.disabled=!0,h.disabled=!1,u.restart()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly82LXR5cGVzY3JpcHQvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsic2NvcmVFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY3ViZVNjb3JlRWxlbWVudCIsImN1YmVFbGVtZW50Iiwia2V5RWxlbWVudCIsIm5vdGlmaWNhdGlvbiIsInByb2dyZXNzVG9wIiwicHJvZ3Jlc3NSaWdodCIsInByb2dyZXNzTGVmdCIsInByb2dyZXNzQm90dG9tIiwic3RhcnRCdG4iLCJzdG9wQnRuIiwibmV3R2FtZUJ0biIsImdhbWUiLCJpbnRlcnZhbCIsImFuaW1hdGlvbkludGVydmFsIiwiY2hhcmFjdGVycyIsImNoYXJhY3RlcnNMZW5ndGgiLCJ0aGlzIiwibGVuZ3RoIiwicmFuZG9tQ2hhcmFjdGVycyIsImlzS2V5UHJlc3MiLCJzdGFydCIsInRleHRBbmltYXRlIiwiY3ljbFByb2dyZXNzQW5pbWF0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Ym1pdHRpbmciLCJiaW5kIiwidGV4dENvbnRlbnQiLCJzdG9wR2FtZSIsInN0b3BBbmltYXRpb24iLCJzdG9wcGluZ1RpbWVycyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZXN0YXJ0Iiwic3R5bGUiLCJ3aWR0aCIsImhlaWdodCIsInRleHRUaW1lciIsInNldFRpbWVvdXQiLCJhbmltYXRpb25UaW1lciIsInNldEludGVydmFsIiwic3RhcnRBbmltYXRpb24iLCJnZW5lcmF0ZUxldHRlciIsImluZGV4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiY2hlY2tpbmdTY29yZSIsImN1cnJlbnRTY29yZSIsImdhbmVyYXRlUG9pbnQiLCJpc0NvcnJlY3RLZXkiLCJtaW4iLCJtYXgiLCJwb2ludCIsInRvdGFsU2NvcmUiLCJwYXJzZUludCIsImN1YmVTaXplIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInBvaW50U3VtIiwidHJhbnNpdGlvbiIsImNsYXNzTGlzdCIsInJlcGxhY2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInRoZW4iLCJ0aW1lcmxlZnQiLCJ0aW1lclRvcCIsInRpbWVyUmlnaHQiLCJkaXNhYmxlQW5pbWF0aW9uIiwiY2xlYXJJbnRlcnZhbCIsInJlc3RhcnRDeWNsZSIsImNvbnRhaW5zIiwiZSIsImtleSIsInRvTG9jYWxlTG93ZXJDYXNlIiwiZGlzYWJsZWQiXSwibWFwcGluZ3MiOiJtQkFDQSxJQUFNQSxFQUFlQyxTQUFTQyxjQUFjLGdCQUN0Q0MsRUFBbUJGLFNBQVNDLGNBQWMscUJBQzFDRSxFQUFjSCxTQUFTQyxjQUFjLGVBQ3JDRyxFQUFhSixTQUFTQyxjQUFjLGNBQ3BDSSxFQUFlTCxTQUFTQyxjQUFjLHVCQUV0Q0ssRUFBY04sU0FBU0MsY0FBYyx1QkFDckNNLEVBQWdCUCxTQUFTQyxjQUFjLHlCQUN2Q08sRUFBZVIsU0FBU0MsY0FBYyx3QkFDdENRLEVBQWlCVCxTQUFTQyxjQUFjLDBCQUV4Q1MsRUFBV1YsU0FBU0MsY0FBYyxnQkFDbENVLEVBQVVYLFNBQVNDLGNBQWMsZUFDakNXLEVBQWFaLFNBQVNDLGNBQWMsY0FpUXBDWSxFQUFPLElBL1BiLFdBa0JJLFdBQ1lkLEVBQ0FHLEVBQ0FDLEVBQ0FDLEVBQ0FLLEVBQ0FELEVBQ0FGLEVBQ0FDLEdBUEEsS0FBQVIsZUFDQSxLQUFBRyxtQkFDQSxLQUFBQyxjQUNBLEtBQUFDLGFBQ0EsS0FBQUssaUJBQ0EsS0FBQUQsZUFDQSxLQUFBRixjQUNBLEtBQUFDLGdCQXhCSixLQUFBTyxTQUFtQixJQUNuQixLQUFBQyxrQkFBNEIsSUFDNUIsS0FBQUMsV0FBcUIsdUNBQ3JCLEtBQUFDLGlCQUEyQkMsS0FBS0YsV0FBV0csT0FTM0MsS0FBQUMsaUJBQTJCLEdBQzNCLEtBQUFDLFlBQXNCLEVBOE9sQyxPQWhPSSxZQUFBQyxNQUFBLFdBQ0lKLEtBQUtLLGNBQ0xMLEtBQUtNLHdCQUNMeEIsU0FBU3lCLGlCQUFpQixVQUFXUCxLQUFLUSxXQUFXQyxLQUFLVCxPQUMxRGIsRUFBYXVCLFlBQWMsSUFHL0IsWUFBQUMs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LGNBQWNwRCxLQUFLaUQsVUFDbkJHLGNBQWNwRCxLQUFLZ0QsWUFJZixZQUFBSyxhQUFSLHNCQUNJbkUsRUFBV3dCLFlBQWMsR0FFckJ4QixFQUFXd0QsVUFBVVksU0FBUyxvQkFDOUJwRSxFQUFXd0QsVUFBVUMsUUFBUSxtQkFBb0IsWUFFakR6RCxFQUFXd0QsVUFBVUMsUUFBUSxXQUFZLG9CQUU3QzNDLEtBQUtZLGdCQUVMUSxZQUFXLFdBQ1AsRUFBS1AsaUJBQ0wsRUFBS1UsaUJBQ0wsRUFBS2pCLDBCQUNOLEtBSUMsWUFBQUUsV0FBUixTQUFtQitDLEdBQ1lBLEVBQUVDLE1BQ0l4RCxLQUFLRSxpQkFBaUJ1RCxxQkFFbkR6RCxLQUFLcUQsZUFDTHJELEtBQUsrQixlQUFjLEtBR25CL0IsS0FBS0csWUFBYSxFQUNsQkgsS0FBS3FELGVBQ0xyRCxLQUFLK0IsZUFBYyxLQUcvQixFQTdQQSxHQStQYSxDQUNUbEQsRUFDQUcsRUFDQUMsRUFDQUMsRUFDQUssRUFDQUQsRUFDQUYsRUFDQUMsR0FxQkpHLEVBQVNlLGlCQUFpQixTQWxCMUIsV0FDSVosRUFBS1MsUUFDTFosRUFBU2tFLFVBQVcsRUFDcEJ0QyxZQUFXLFdBQU0sT0FBQTNCLEVBQVFpRSxVQUFXLElBQU8sUUFnQi9DakUsRUFBUWMsaUJBQWlCLFNBYnpCLFdBQ0lmLEVBQVNrRSxVQUFXLEVBQ3BCakUsRUFBUWlFLFVBQVcsRUFDbkIvRCxFQUFLZ0IsY0FXVGpCLEVBQVdhLGlCQUFpQixTQVI1QixXQUNJZCxFQUFRaUUsVUFBVyxFQUNuQmxFLEVBQVNrRSxVQUFXLEVBQ3BCL0QsRUFBS29CLGMiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gbWFpbiBnYW1lIGVsZW1lbnRcbmNvbnN0IHNjb3JlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNjb3JlXScpIGFzIEhUTUxIZWFkaW5nRWxlbWVudDtcbmNvbnN0IGN1YmVTY29yZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jdWJlLXNjb3JlXScpIGFzIEhUTUxIZWFkaW5nRWxlbWVudDtcbmNvbnN0IGN1YmVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY3ViZV0nKSBhcyBIVE1MRGl2RWxlbWVudDtcbmNvbnN0IGtleUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1rZXldJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5jb25zdCBub3RpZmljYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1ub3RpZmljYXRpb25dJykgYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XG4vLyBwcm9ncmVzIGJhcnIgZWxlbWVudFxuY29uc3QgcHJvZ3Jlc3NUb3AgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wcm9ncmVzcy10b3BdJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5jb25zdCBwcm9ncmVzc1JpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtcHJvZ3Jlc3MtcmlnaHRdJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5jb25zdCBwcm9ncmVzc0xlZnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wcm9ncmVzcy1sZWZ0XScpIGFzIEhUTUxEaXZFbGVtZW50O1xuY29uc3QgcHJvZ3Jlc3NCb3R0b20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wcm9ncmVzcy1ib3R0b21dJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4vLyBidXR0b24gZWxlbWVudFxuY29uc3Qgc3RhcnRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zdGFydF0nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbmNvbnN0IHN0b3BCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zdG9wXScpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuY29uc3QgbmV3R2FtZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW5ld10nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcblxuY2xhc3MgR2FtZSB7XG4gICAgLy8gbWFpbiBnYW1lIHZhcmlhYmxlc1xuICAgIHByaXZhdGUgaW50ZXJ2YWw6IG51bWJlciA9IDIwMDA7XG4gICAgcHJpdmF0ZSBhbmltYXRpb25JbnRlcnZhbDogbnVtYmVyID0gNDgwO1xuICAgIHByaXZhdGUgY2hhcmFjdGVyczogc3RyaW5nID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaMDEyMzQ1Njc4OSc7XG4gICAgcHJpdmF0ZSBjaGFyYWN0ZXJzTGVuZ3RoOiBudW1iZXIgPSB0aGlzLmNoYXJhY3RlcnMubGVuZ3RoO1xuICAgIC8vIHRpbWVycyBmb3IgYW5pbWF0aW9uXG4gICAgcHJpdmF0ZSB0ZXh0VGltZXI6IGFueTtcbiAgICBwcml2YXRlIGFuaW1hdGlvblRpbWVyOiBhbnk7XG4gICAgcHJpdmF0ZSB0aW1lclJpZ2h0OiBhbnk7XG4gICAgcHJpdmF0ZSB0aW1lclRvcDogYW55O1xuICAgIHByaXZhdGUgdGltZXJsZWZ0OiBhbnk7XG4gICAgXG4gICAgcHJpdmF0ZSBkaXNhYmxlQW5pbWF0aW9uOiBhbnk7XG4gICAgcHJpdmF0ZSByYW5kb21DaGFyYWN0ZXJzOiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIGlzS2V5UHJlc3M6IGJvb2xlYW4gPSBmYWxzZTtcblxuXG4gICAgY29uc3RydWN0b3IgKFxuICAgICAgICBwcml2YXRlIHNjb3JlRWxlbWVudDogSFRNTEhlYWRpbmdFbGVtZW50LFxuICAgICAgICBwcml2YXRlIGN1YmVTY29yZUVsZW1lbnQ6IEhUTUxIZWFkaW5nRWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBjdWJlRWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUga2V5RWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcHJvZ3Jlc3NCb3R0b206IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHByb2dyZXNzTGVmdDogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcHJvZ3Jlc3NUb3A6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHByb2dyZXNzUmlnaHQ6IEhUTUxEaXZFbGVtZW50LFxuICAgICkge31cblxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnRleHRBbmltYXRlKCk7XG4gICAgICAgIHRoaXMuY3ljbFByb2dyZXNzQW5pbWF0aW9uKCk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLnN1Ym1pdHRpbmcuYmluZCh0aGlzKSk7XG4gICAgICAgIG5vdGlmaWNhdGlvbi50ZXh0Q29udGVudCA9ICcnO1xuICAgIH1cblxuICAgIHN0b3BHYW1lKCkge1xuICAgICAgICBrZXlFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIG5vdGlmaWNhdGlvbi50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgICAgdGhpcy5zdG9wcGluZ1RpbWVycygpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5zdWJtaXR0aW5nLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHJlc3RhcnQoKSB7XG4gICAgICAgIHNjb3JlRWxlbWVudC50ZXh0Q29udGVudCA9ICcxMDAnO1xuICAgICAgICBjdWJlU2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gJzAnO1xuICAgICAgICBjdWJlRWxlbWVudC5zdHlsZS53aWR0aCA9IGAxMDBweGA7XG4gICAgICAgIGN1YmVFbGVtZW50LnN0eWxlLmhlaWdodCA9IGAxMDBweGA7XG4gICAgICAgIHRoaXMuc3RvcEdhbWUoKTtcbiAgICB9XG5cbiAgICAvLyBzdGFydCB0ZXh0IGFuaW1hdGlvblxuICAgIHRleHRBbmltYXRlKCkge1xuICAgICAgICB0aGlzLnRleHRUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uLnRleHRDb250ZW50ID0gJzEnO1xuICAgICAgICB9LCA1MDApO1xuICAgICAgICB0aGlzLnRleHRUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uLnRleHRDb250ZW50ID0gJzInO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgdGhpcy50ZXh0VGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbi50ZXh0Q29udGVudCA9ICczJztcbiAgICAgICAgfSwgMTUwMCk7XG4gICAgICAgIHRoaXMudGV4dFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBub3RpZmljYXRpb24udGV4dENvbnRlbnQgPSAnU3RhcnQgdHlwaW5nISc7XG4gICAgICAgIH0sIDIwMDApO1xuICAgICAgICB0aGlzLnRleHRUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIH0sIDMwMDApO1xuICAgIH1cblxuICAgIC8vIHBlcmZvcm0gYW5pbWF0aW9uIGV2ZXJ5IDIgc2Vjb25kc1xuICAgIHByaXZhdGUgY3ljbFByb2dyZXNzQW5pbWF0aW9uKCkge1xuICAgICAgICB0aGlzLmFuaW1hdGlvblRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGFydEFuaW1hdGlvbigpO1xuICAgICAgICB9LCB0aGlzLmludGVydmFsKTtcbiAgICB9XG5cbiAgICAvLyBnZXR0aW5nIHJhbmRvbSBjaGFyYWN0ZXJcbiAgICBwcml2YXRlIGdlbmVyYXRlTGV0dGVyKCkge1xuICAgICAgICBjb25zdCBpbmRleDogbnVtYmVyID0gTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAqIHRoaXMuY2hhcmFjdGVyc0xlbmd0aCkgKyAxKTtcbiAgICAgICAgdGhpcy5yYW5kb21DaGFyYWN0ZXJzID0gdGhpcy5jaGFyYWN0ZXJzW2luZGV4IC0gMV07XG4gICAgICAgIGtleUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLnJhbmRvbUNoYXJhY3RlcnM7XG4gICAgfVxuXG4gICAgLy8gY2hlY2tpbmcgY3VycmVudCBzY29yZVxuICAgIHByaXZhdGUgY2hlY2tpbmdTY29yZShjdXJyZW50U2NvcmU6IG51bWJlcikge1xuICAgICAgICBpZiAoY3VycmVudFNjb3JlID4gMjAwKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3BHYW1lKCk7XG4gICAgICAgICAgICBzY29yZUVsZW1lbnQudGV4dENvbnRlbnQgPSAnWW91IFdpbiEnXG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFNjb3JlIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wR2FtZSgpO1xuICAgICAgICAgICAgc2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gJ1lvdSBMb3NlISdcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIHNldHRpbmcgcmFuZG9tIHBvaW50IGFuZCBjaGFuZ2UgY3ViZSBzaXplXG4gICAgcHJpdmF0ZSBnYW5lcmF0ZVBvaW50KGlzQ29ycmVjdEtleTogYm9vbGVhbikge1xuICAgICAgICAvLyBpZiBwcmVzc2VkIHN1Y2Nlc3NmdWxseVxuICAgICAgICBpZiAoaXNDb3JyZWN0S2V5KSB7XG4gICAgICAgICAgICAvLyBnZW5lcmF0ZSByYW5kb20gbnVtYmVyXG4gICAgICAgICAgICBjb25zdCBtaW46IG51bWJlciA9IDU7XG4gICAgICAgICAgICBjb25zdCBtYXg6IG51bWJlciA9IDEwO1xuICAgICAgICAgICAgY29uc3QgcG9pbnQ6IG51bWJlciA9IE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluKTtcbiAgICAgICAgICAgIC8vIGluc2VydGluZyB0aGlzIGFtb3VudCBpbiBET01cbiAgICAgICAgICAgIGN1YmVTY29yZUVsZW1lbnQudGV4dENvbnRlbnQgPSBgKyR7cG9pbnR9YDtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsU2NvcmU6IG51bWJlciA9IHBhcnNlSW50KHNjb3JlRWxlbWVudC50ZXh0Q29udGVudCEpO1xuICAgICAgICAgICAgc2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gYCR7dG90YWxTY29yZSArIHBvaW50fWA7XG4gICAgICAgICAgICAvLyBjaGFuZ2luZyBjdWJlIHNpemUgXG4gICAgICAgICAgICBjb25zdCBjdWJlU2l6ZTogbnVtYmVyID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShjdWJlRWxlbWVudCwpLndpZHRoKTtcbiAgICAgICAgICAgIGN1YmVFbGVtZW50LnN0eWxlLndpZHRoID0gYCR7Y3ViZVNpemUgKyBwb2ludH1weGA7XG4gICAgICAgICAgICBjdWJlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtjdWJlU2l6ZSArIHBvaW50fXB4YDtcbiAgICAgICAgLy8gaWYgZmFpbCB0byBwcmVzc1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZ2VuZXJhdGUgcmFuZG9tIG51bWJlciBiZXR3ZWVuIG1pbiBhbmQgbWF4XG4gICAgICAgICAgICBsZXQgbWluOiBudW1iZXI7XG4gICAgICAgICAgICBsZXQgbWF4OiBudW1iZXI7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0tleVByZXNzKSB7XG4gICAgICAgICAgICAgICAgbWluID0gMjA7XG4gICAgICAgICAgICAgICAgbWF4ID0gMjU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1pbiA9IDEwO1xuICAgICAgICAgICAgICAgIG1heCA9IDE1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcG9pbnQ6IG51bWJlciA9IE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluKTtcbiAgICAgICAgICAgIC8vIGluc2VydGluZyB0aGlzIGFtb3VudCBpbiBET01cbiAgICAgICAgICAgIGN1YmVTY29yZUVsZW1lbnQudGV4dENvbnRlbnQgPSBgLSR7cG9pbnR9YDtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsU2NvcmU6IG51bWJlciA9IHBhcnNlSW50KHNjb3JlRWxlbWVudC50ZXh0Q29udGVudCEpO1xuICAgICAgICAgICAgc2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gYCR7dG90YWxTY29yZSAtIHBvaW50fWA7XG4gICAgICAgICAgICAvLyBjaGFuZ2luZyBjdWJlIHNpemUgXG4gICAgICAgICAgICBjb25zdCBjdWJlU2l6ZTogbnVtYmVyID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShjdWJlRWxlbWVudCwpLndpZHRoKTtcbiAgICAgICAgICAgIGNvbnN0IHBvaW50U3VtOiBudW1iZXIgPSBjdWJlU2l6ZSAtIHBvaW50O1xuICAgICAgICAgICAgY3ViZUVsZW1lbnQuc3R5bGUud2lkdGggPSBgJHtwb2ludFN1bX1weGA7XG4gICAgICAgICAgICBjdWJlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtwb2ludFN1bX1weGA7XG4gICAgICAgICAgICB0aGlzLmNoZWNraW5nU2NvcmUocG9pbnRTdW0pO1xuICAgICAgICAgICAgdGhpcy5pc0tleVByZXNzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBzdG9wcGluZyBhbmltYXRpb24gd2l0aCBsaXR0bGUgZGVsZXkgdG8gYXBwbHkgc3R5bGVzIGNvcnJlY3RseVxuICAgIHByaXZhdGUgc3RvcEFuaW1hdGlvbigpIHtcbiAgICAgICAgLy8gc2V0IHRyYW5zaXRpb24gMCBzZWNvbmQgdG8gZGlzYWJsZSBzbW9vdGhuZXNzXG4gICAgICAgIHByb2dyZXNzQm90dG9tLnN0eWxlLnRyYW5zaXRpb24gPSAnbm9uZSc7XG4gICAgICAgIHByb2dyZXNzTGVmdC5zdHlsZS50cmFuc2l0aW9uID0gJ25vbmUnO1xuICAgICAgICBwcm9ncmVzc1RvcC5zdHlsZS50cmFuc2l0aW9uID0gJ25vbmUnO1xuICAgICAgICBwcm9ncmVzc1JpZ2h0LnN0eWxlLnRyYW5zaXRpb24gPSAnbm9uZSc7XG4gICAgICAgIC8vIHJldHVybiB0aGUgcHJvZ3Jlc3MgbGluZSB0byB0aGUgZGVmYXVsdCBwb3NpdGlvblxuICAgICAgICBwcm9ncmVzc0JvdHRvbS5zdHlsZS53aWR0aCA9ICcwJztcbiAgICAgICAgcHJvZ3Jlc3NMZWZ0LnN0eWxlLmhlaWdodCA9ICcwJztcbiAgICAgICAgcHJvZ3Jlc3NUb3Auc3R5bGUud2lkdGggPSAnMCc7XG4gICAgICAgIHByb2dyZXNzUmlnaHQuc3R5bGUuaGVpZ2h0ID0gJzAnO1xuICAgICAgICAvLyB0dXJuIG9uIHNtb290aG5lc3NcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBwcm9ncmVzc0JvdHRvbS5zdHlsZS50cmFuc2l0aW9uID0gJy40OHMgYWxsIGxpbmVhcic7XG4gICAgICAgICAgICBwcm9ncmVzc0xlZnQuc3R5bGUudHJhbnNpdGlvbiA9ICcuNDhzIGFsbCBsaW5lYXInO1xuICAgICAgICAgICAgcHJvZ3Jlc3NUb3Auc3R5bGUudHJhbnNpdGlvbiA9ICcuNDhzIGFsbCBsaW5lYXInO1xuICAgICAgICAgICAgcHJvZ3Jlc3NSaWdodC5zdHlsZS50cmFuc2l0aW9uID0gJy40OHMgYWxsIGxpbmVhcic7XG4gICAgICAgIH0sIDQwKTtcbiAgICB9XG5cbiAgICAvLyBzcnRpbmcgYW5pbWF0aW9uIGV2ZXJ5IHR3byBzZWNvbmRcbiAgICBwcml2YXRlIHN0YXJ0QW5pbWF0aW9uKCkge1xuICAgICAgICBrZXlFbGVtZW50LmNsYXNzTGlzdC5yZXBsYWNlKCdoaWRkZW4nLCAnYW5pbWF0ZWQnKTtcbiAgICAgICAga2V5RWxlbWVudC5jbGFzc0xpc3QucmVwbGFjZSgnaGlkZGVuLWFuaW1hdGVkJywgJ2FuaW1hdGVkJyk7XG4gICAgICAgIC8vIGdhbmVyYXRlIGNoYXJhY3RlcnMgZXZlcnkgdHdvIHNlY29uZFxuICAgICAgICB0aGlzLmdlbmVyYXRlTGV0dGVyKCk7XG4gICAgICAgIC8vIHN0YXJ0IHByb2dyZXNzIGJhciBhbmltYXRpb25zIHdpdGggZGVsZXkgZm9yIGVhY2ggLyBib3R0b20gbGluZVxuICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZTogKHZhbHVlPzogYW55KSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBwcm9ncmVzc0JvdHRvbS5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLy8gbGVmdCBsaW5lXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZTogKHZhbHVlPzogYW55KSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVybGVmdCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc0xlZnQuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSwgdGhpcy5hbmltYXRpb25JbnRlcnZhbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgLy8gdG9wIGxpbmVcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlOiAodmFsdWU/OiBhbnkpID0+IHZvaWQsIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMudGltZXJUb3AgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NUb3Auc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzLmFuaW1hdGlvbkludGVydmFsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAvLyByaWdodCBsaW5lXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZTogKHZhbHVlPzogYW55KSA9PiB2b2lkLCByZWplY3Q6IChyZWFzb24/OiBhbnkpID0+IHZvaWQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyUmlnaHQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAga2V5RWxlbWVudC5jbGFzc0xpc3QucmVwbGFjZSgnYW5pbWF0ZWQtb25QcmVzcycsICdoaWRkZW4tYW5pbWF0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAga2V5RWxlbWVudC5jbGFzc0xpc3QucmVwbGFjZSgnYW5pbWF0ZWQnLCAnaGlkZGVuLWFuaW1hdGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHByb2dyZXNzUmlnaHQuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSwgdGhpcy5hbmltYXRpb25JbnRlcnZhbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgLy8gZGlzYWJsZSBhbmltYXRpb25cbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlOiAodmFsdWU/OiBhbnkpID0+IHZvaWQsIHJlamVjdDogKHJlYXNvbj86IGFueSkgPT4gdm9pZCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZUFuaW1hdGlvbiA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW5lcmF0ZVBvaW50KGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMuYW5pbWF0aW9uSW50ZXJ2YWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gY2xlYXQgYWxsIHRpbWVyIHRvIHN0YXJ0IG5ldyBjaWNsIGFuaW1hdGlvbiBvciBzdG9wIHRoZSBnYW1lXG4gICAgcHJpdmF0ZSBzdG9wcGluZ1RpbWVycygpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmRpc2FibGVBbmltYXRpb24pO1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuYW5pbWF0aW9uVGltZXIpO1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXJSaWdodCk7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lclRvcCk7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcmxlZnQpO1xuICAgIH1cblxuICAgIC8vIHJlc3RhcnQgY3ljbGUgb2YgYW5pbWF0aW9uIHdoZSBrZXkgcHJlc3NlZFxuICAgIHByaXZhdGUgcmVzdGFydEN5Y2xlKCkge1xuICAgICAgICBrZXlFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIC8vIHNldHRpbmcgdGhlIHNhbWUgYW5pbWF0aW9uIGJ1dCB3aXRoIGRpZmZlcmVudCBhbmltYXRpb24gbmFtZSB0byBjb3JyZWN0bHkgd29ya1xuICAgICAgICBpZiAoa2V5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2FuaW1hdGVkLW9uUHJlc3MnKSkge1xuICAgICAgICAgICAga2V5RWxlbWVudC5jbGFzc0xpc3QucmVwbGFjZSgnYW5pbWF0ZWQtb25QcmVzcycsICdhbmltYXRlZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAga2V5RWxlbWVudC5jbGFzc0xpc3QucmVwbGFjZSgnYW5pbWF0ZWQnLCAnYW5pbWF0ZWQtb25QcmVzcycpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuICAgICAgICAvLyBuZWVkZWQgYSBsaXR0bGUgZGVsYXkgZm9yIGFsbCBzdHlsZXMgdG8gYmUgc2V0IGluIG9yZGVyIGFuZCB3b3JrIGNvcnJlY3RseVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RvcHBpbmdUaW1lcnMoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRBbmltYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuY3ljbFByb2dyZXNzQW5pbWF0aW9uKCk7XG4gICAgICAgIH0sIDUwKTtcbiAgICB9XG5cbiAgICAvLyBpZGVudGlmeSB0aGUga2V5IHRoYXQgd2FzIHByZXNzZWRcbiAgICBwcml2YXRlIHN1Ym1pdHRpbmcoZTogYW55KSB7XG4gICAgICAgIGNvbnN0IHByZXNzZWRLZXk6IHN0cmluZyA9IGUua2V5O1xuICAgICAgICBjb25zdCBzaG93ZWRDaGFyYWN0ZXJzOiBzdHJpbmcgPSB0aGlzLnJhbmRvbUNoYXJhY3RlcnMudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKHByZXNzZWRLZXkgPT09IHNob3dlZENoYXJhY3RlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdGFydEN5Y2xlKCk7XG4gICAgICAgICAgICB0aGlzLmdhbmVyYXRlUG9pbnQodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmlzS2V5UHJlc3MgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5yZXN0YXJ0Q3ljbGUoKTtcbiAgICAgICAgICAgIHRoaXMuZ2FuZXJhdGVQb2ludChmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNvbnN0IGdhbWUgPSBuZXcgR2FtZShcbiAgICBzY29yZUVsZW1lbnQsXG4gICAgY3ViZVNjb3JlRWxlbWVudCxcbiAgICBjdWJlRWxlbWVudCxcbiAgICBrZXlFbGVtZW50LFxuICAgIHByb2dyZXNzQm90dG9tLFxuICAgIHByb2dyZXNzTGVmdCxcbiAgICBwcm9ncmVzc1RvcCxcbiAgICBwcm9ncmVzc1JpZ2h0XG4pO1xuXG5mdW5jdGlvbiBzdGFydCgpIHtcbiAgICBnYW1lLnN0YXJ0KCk7XG4gICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIHNldFRpbWVvdXQoKCkgPT4gc3RvcEJ0bi5kaXNhYmxlZCA9IGZhbHNlLCAyMDAwKTtcbn1cblxuZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBzdGFydEJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIHN0b3BCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIGdhbWUuc3RvcEdhbWUoKTtcbn1cblxuZnVuY3Rpb24gcmVzdGFydCgpIHtcbiAgICBzdG9wQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICBzdGFydEJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGdhbWUucmVzdGFydCgpO1xufVxuXG5zdGFydEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0YXJ0KTtcbnN0b3BCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wKTtcbm5ld0dhbWVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXN0YXJ0KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=